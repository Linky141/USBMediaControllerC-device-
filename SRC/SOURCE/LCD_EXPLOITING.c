/*
 * lcdshow.c
 *
 *  Created on: 3 lut 2019
 *      Author: Tomasz Bielas
 */

#include "../HEADERS/LCD_EXPLOITING.h"

void LCDEXPLOITING_SetLctBrightness(int val) {
	if (val < 0 || val > 100)
		return;
	int tmp = 100 - val;
	PWM_SetDutyCycle(1, tmp);
}

void screen_show_initialize(bool ledStatus,
		struct LCDEXPLOITING_AllPages *lcdPageLabbles,
		struct SettingsMenu_values *settinsgMenu_values) {

	LCD_Clear();
	LCD_XYPrintf(3, 0, "Waiting for");
	LCD_XYPrintf(3, 1, "connection");
	LedControl_OFF(500);
	LCDEXPLOITING_SetLctBrightness(0);
	UART_Printf("RTW!\n");		//redy to write



	UART_RxString(lcdPageLabbles->page1.field1);
	LCDEXPLOITING_SetLctBrightness(settinsgMenu_values->pwmBrightness);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "11:%s", lcdPageLabbles->page1.field1);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(1);

	UART_RxString(lcdPageLabbles->page1.field2);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "12:%s", lcdPageLabbles->page1.field2);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(2);

	UART_RxString(lcdPageLabbles->page1.field3);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "13:%s", lcdPageLabbles->page1.field3);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(3);

	UART_RxString(lcdPageLabbles->page1.field4);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "14:%s", lcdPageLabbles->page1.field4);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(4);

	UART_RxString(lcdPageLabbles->page2.field1);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "21:%s", lcdPageLabbles->page2.field1);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(5);

	UART_RxString(lcdPageLabbles->page2.field2);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "22:%s", lcdPageLabbles->page2.field2);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(6);

	UART_RxString(lcdPageLabbles->page2.field3);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "23:%s", lcdPageLabbles->page2.field3);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(7);

	UART_RxString(lcdPageLabbles->page2.field4);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "24:%s", lcdPageLabbles->page2.field4);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(8);

	UART_RxString(lcdPageLabbles->page3.field1);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "31:%s", lcdPageLabbles->page3.field1);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(9);

	UART_RxString(lcdPageLabbles->page3.field2);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "32:%s", lcdPageLabbles->page3.field2);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(10);

	UART_RxString(lcdPageLabbles->page3.field3);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "33:%s", lcdPageLabbles->page3.field3);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(11);

	UART_RxString(lcdPageLabbles->page3.field4);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "34:%s", lcdPageLabbles->page3.field4);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(12);

	UART_RxString(lcdPageLabbles->page4.field1);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "41:%s", lcdPageLabbles->page4.field1);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(13);

	UART_RxString(lcdPageLabbles->page4.field2);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "42:%s", lcdPageLabbles->page4.field2);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(14);

	UART_RxString(lcdPageLabbles->page4.field3);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "43:%s", lcdPageLabbles->page4.field3);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(15);

	UART_RxString(lcdPageLabbles->page4.field4);
	LCD_Clear();
	LCD_SetCursor(0, 0);
	if (settinsgMenu_values->debugMode == 1)
		LCD_XYPrintf(0, 0, "44:%s", lcdPageLabbles->page4.field4);
	else
		LCD_XYPrintf(0, 0, "Please wait");
	LCDEXPLOITING_DrawLoading(16);

	_delay_ms(500);
	LCD_Clear();
	LCD_XYPrintf(0, 0, "initialization");
	LCD_XYPrintf(0, 1, "completed");
	if (ledStatus) {
		LedControl_OFF(125);
		LedControl_ON(125);
		LedControl_OFF(125);
		LedControl_ON(125);
		LedControl_OFF(125);
		LedControl_ON(125);
		LedControl_OFF(125);
		LedControl_ON(125);
		LedControl_OFF(200);
	} else DELAY_ms(1200);
	LCD_Clear();
}

void LCDEXPLOITING_showPage(int page,
		struct LCDEXPLOITING_AllPages *lcdPageLabbles) {
	LCD_Clear();
	int space;
	if (page == 1) {
		LCD_XYPrintf(0, 0, "%s", lcdPageLabbles->page1.field1);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page1.field2);
		LCD_XYPrintf((9 + space), 0, "%s", lcdPageLabbles->page1.field2);
		LCD_XYPrintf(0, 1, "%s", lcdPageLabbles->page1.field3);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page1.field4);
		LCD_XYPrintf((9 + space), 1, "%s", lcdPageLabbles->page1.field4);
	} else if (page == 2) {
		LCD_XYPrintf(0, 0, "%s", lcdPageLabbles->page2.field1);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page2.field2);
		LCD_XYPrintf((9 + space), 0, "%s", lcdPageLabbles->page2.field2);
		LCD_XYPrintf(0, 1, "%s", lcdPageLabbles->page2.field3);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page2.field4);
		LCD_XYPrintf((9 + space), 1, "%s", lcdPageLabbles->page2.field4);
	} else if (page == 3) {
		LCD_XYPrintf(0, 0, "%s", lcdPageLabbles->page3.field1);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page3.field2);
		LCD_XYPrintf((9 + space), 0, "%s", lcdPageLabbles->page3.field2);
		LCD_XYPrintf(0, 1, "%s", lcdPageLabbles->page3.field3);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page3.field4);
		LCD_XYPrintf((9 + space), 1, "%s", lcdPageLabbles->page3.field4);
	} else if (page == 4) {
		LCD_XYPrintf(0, 0, "%s", lcdPageLabbles->page4.field1);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page4.field2);
		LCD_XYPrintf((9 + space), 0, "%s", lcdPageLabbles->page4.field2);
		LCD_XYPrintf(0, 1, "%s", lcdPageLabbles->page4.field3);
		space = LCDEXPLOITING_howLong(lcdPageLabbles->page4.field4);
		LCD_XYPrintf((9 + space), 1, "%s", lcdPageLabbles->page4.field4);
	}


}
int LCDEXPLOITING_howLong(char *chars) {
	int size = 0;
	int specialSymbols=0;

	for(int clk=0; chars[clk] != '\0'; clk++){
		size++;
		if(chars[clk] == '%') specialSymbols++;
	}
	return ((7 - size)+specialSymbols);
}

void LCDEXPLOITING_DrawLoading(int length) {
	for (int clk = 0; clk < length; clk++){
		LCD_XYPrintf(clk, 1, "%?");
	}
}

